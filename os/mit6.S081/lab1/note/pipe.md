## pipe
> 管道分为匿名管道和命名管道，匿名管道较为常见，例如命令行中`|`就是匿名管道，平时进程间通信时通过`pipe`创建的也是匿名管道。

`pipe`经常用于实现进程间通信，但需要注意的是：其本质上是内核的一段缓冲区，之所以能用于进程间通信，是由于`fork`将`fd`复制到子进程内实现的。故匿名管道由于基于子进程复制父进程的地址空间从而实现两者通信，因此对于其他进程是不可见的。

对于命名管道，我们可以通过`mkfifo`创建，对任何进程可见，（我）目前使用较少，不再过多阐述。

下面看下管道读写的特点：

在管道中没有数据的情况下，对管道的读操作会`阻塞`，直到管道内有数据为止。当一次写的数据量不超过管道容量的时候，对管道的写操作`一般不会阻塞`，直接将要写的数据写入管道缓冲区即可。

读取时只需要关心每次读取内容的字节数，读取之后会改变fd的offset。如果写入端被关闭，`read`函数会直接返回0，**写入端的关闭不仅仅是某一个进程，而是要父子进程均关闭才行。**

### 扩展

shell中管道操作符 `|` 便是基于`pipe`实现，需要区分其和重定向的区别，虽然都是改变输入输出方向，但是重定向用于命令和文件，管道操作符用于命令与命令。

